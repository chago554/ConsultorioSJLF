<script>
    //cargar datos del paciente elegido y ponerlos en los inputs
    function cargarPaciente(idPaciente) {
        var datos = {
            id: idPaciente
        }

        $.ajax({
            url: backend + "/pacientesSJLF/consultarSJLF",
            type: 'post',
            datatype: 'json',
            data: JSON.stringify(datos),
            contentType: 'application/json',
            xhrFields: { withCredentials: true },

            success: function (respuesta) {
                console.log(respuesta);
                $("#nombre").val(respuesta.nombreSJLF);
                $("#curp").val(respuesta.curpSJLF),
                    $("#comboTipoSangre").val(respuesta.tipoSangre),
                    $("#idPaciente").val(respuesta.id)
            }
        });
    }

    //guardar paciente

    function guardarPaciente() {

        var datos = {
            nombreSJLF: $("#nombre").val(),
            curpSJLF: $("#curp").val(),
            tipoSangre: $("#comboTipoSangre").val(),
            id: $("#idPaciente").val()
        };

        $.ajax({
            url: backend + "/pacientesSJLF/modificarSJLF",
            type: 'post', //es un metod post
            datatype: 'json', //se espera respuesta del server en JOSN
            data: JSON.stringify(datos),// Convierte los datos que se van a enviar al servidor en una cadena JSON
            contentType: 'application/json',//Los datos que se envían es JSON.
            xhrFields: { withCredentials: true },

            success: function (respuesta) {
                console.log(respuesta);

                if (respuesta == '¡Paciente actualizado exitosamente!') {

                    $("#divPrincipal").load("Pacientes/pacientes.html", function () {
                        var alerta = '<div class="alert alert-dismissible alert-primary ">' +
                            '<button type="button" class="btn-close" data-bs-dismiss="alert"></button>' +
                            ' <strong class="h5">' + respuesta + '</strong>';

                        $("#divAlertas").html(alerta);
                        setTimeout(() => {
                            $("#divAlertas").html(null);
                        }, 2000);
                    });


                } else {
                    var alerta = '<div class="alert alert-dismissible alert-primary ">' +
                        '<button type="button" class="btn-close" data-bs-dismiss="alert"></button>' +
                        ' <strong class="h5">' + respuesta + '</strong>';

                    $("#divAlertas").html(alerta);
                    setTimeout(() => {
                        $("#divAlertas").html(null);
                    }, 3000);
                }
            }
        })
    }
</script>



<div class="col">
    <div class="row p-5">
        <input type="hidden" id="idPaciente">
        <div>
            <legend class="h1">Guardar un nuevo paciente</legend>
            <fieldset>
                <label class="form-label text-dark fw-bold" for="consultarSJLF">Nombre(s)</label>
                <input class="form-control" id="nombre" type="text" placeholder="Proporcione su nombre ">
            </fieldset>
        </div>


        <div>
            <fieldset>
                <label class="form-label mt-4 text-dark fw-bold" for="curp">CURP</label>
                <input class="form-control" id="curp" type="text" minlength="18" maxlength="18"
                    placeholder="Ingrese su CURP">
            </fieldset>
        </div>


        <div>
            <fieldset>
                <label class="form-label mt-4 text-dark fw-bold" for="comboTipoSangre">Tipo de sangre</label>
                <select class="form-select" id="comboTipoSangre">
                    <option value="OPositivo">O+</option>
                    <option value="ONegativo">O-</option>
                    <option value="APositivo">A+</option>
                    <option value="ANegativo">A-</option>
                    <option value="BPositivo">B+</option>
                    <option value="BNegativo">B-</option>
                    <option value="ABPositivo">AB+</option>
                    <option value="ABNegativo">AB-</option>
                </select>
            </fieldset>
        </div>
        <div class="form-control">
            <button class="btn btn-dark "
                onclick='$("#divPrincipal").load("Pacientes/pacientes.html")'>Regresar</button>
            <button class="btn btn-info" onclick='guardarPaciente()'>Guardar</button>
        </div>
    </div>
</div>